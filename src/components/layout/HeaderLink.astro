---
import type { HTMLAttributes } from 'astro/types';
import { getLangFromUrl } from '@/i18n/utils';

type Props = HTMLAttributes<'a'>;

const { href, class: className, ...props } = Astro.props;
const lang = getLangFromUrl(Astro.url);

const pathname = Astro.url.pathname;
const isActive = href === pathname || 
                 href === pathname.replace(/\/$/, '') ||
                 (href !== `/${lang}` && pathname.startsWith(String(href)));
---

<a 
    href={href} 
    class:list={[
        className, 
        'inline-block no-underline border-b-2 transition-all duration-300 py-1 text-sm font-medium hover:text-accent',
        { 'active-link border-accent font-bold': isActive },
        { 'text-mono-gray border-transparent': !isActive }
    ]} 
    {...props}
>
    <slot />
</a>

<style>
    /* Link inactivo (gris) */
    a:not(.active-link) {
        color: var(--color-mono-gray);
    }

    /* Link activo (negro/blanco seg√∫n tema) */
    .active-link {
        color: var(--text-main);
    }
</style>