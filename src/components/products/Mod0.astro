---
import { MOD0_FULL_CONFIG } from '@/config/products/mod0/config';
import { getI18nPath, getLangFromUrl, useTranslations } from '@/i18n/utils';

import RotatingText from '@/components/islands/RotatingText';
import { Terminal, AnimatedSpan, TypingAnimation } from '@/components/islands/Terminal';

import Features from '@/components/common/Features.astro';
import HowItWorks from '@/components/common/HowItWorks.astro';
import Pricing from '@/components/common/Pricing.astro';
import FAQ from '@/components/common/FAQ.astro';
import FutureNews from '@/components/common/FutureNews.astro';

const lang = getLangFromUrl(Astro.url);
const t = useTranslations(lang);
const base = import.meta.env.BASE_URL;

const rotatingWords = ["intelligent", "agentic", "autonomic", "precise", "modern"]
  .map(word => t(`products.mod0.rotating_words.${word}`));
---

<div class="w-full bg-app text-main">
  <section class="relative px-4 pt-32 pb-20 sm:px-6 lg:px-8 overflow-hidden bg-transparent">
    <div class="mx-auto max-w-7xl">
      <div class="grid lg:grid-cols-2 gap-16 items-center">
        
        <div class="relative z-10 text-left">
          <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-accent/10 border border-accent/20 text-accent text-xs font-bold uppercase tracking-widest mb-6">
            <span class="relative flex h-2 w-2">
              <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-accent opacity-75"></span>
              <span class="relative inline-flex rounded-full h-2 w-2 bg-accent"></span>
            </span>
            {t('products.mod0.name')} 
            <RotatingText 
              client:load
              texts={rotatingWords}
              mainClassName="ml-1 text-accent"
              staggerDuration={0.02}
              rotationInterval={3000}
              transition={{ type: "spring", damping: 25, stiffness: 300 }}
            />
          </div>
          
          <h1 class="hero-title text-5xl lg:text-7xl font-black tracking-tighter mb-6 leading-[1.1] transition-all duration-500">
            {t('products.mod0.tagline')}
          </h1>
          
          <p class="text-lg md:text-xl opacity-80 max-w-xl mb-10 leading-relaxed drop-shadow-sm">
            {t('products.mod0.description')}
          </p>

          <div class="flex flex-col sm:flex-row gap-4">
            <a 
              href={getI18nPath(base, lang, 'resources/releases')}
              aria-label={t('products.mod0.get_started')}
              class="cursor-target bg-accent text-white px-8 py-4 rounded-xl font-bold shadow-[0_10px_30px_rgba(14,165,233,0.3)] hover:-translate-y-1 transition-all active:scale-95">
              {t('products.mod0.get_started')}
            </a>
            <a 
              href={getI18nPath(base, lang, 'resources/docs')}
              aria-label={t('products.mod0.learn_more')}
              class="cursor-target inline-flex items-center justify-center text-center px-8 py-4 rounded-xl font-bold border backdrop-blur-md transition-all duration-300 hover:bg-(--text-main)/10 active:scale-95 shadow-lg"
              style="border-color: var(--border-main); color: var(--text-main);">
              {t('products.mod0.learn_more')}
            </a>
          </div>
        </div>

        <div class="relative flex justify-center lg:justify-end group">
          <div class="cursor-target terminal-wrapper relative w-full max-w-[440px] transition-all duration-700">
            
            <div class="relative z-10 rounded-2xl border border-border-main overflow-hidden backdrop-blur-xl bg-white/5 dark:bg-black/40">
              <Terminal client:load>
                <TypingAnimation client:load>{"$ mod0 init --agentic"}</TypingAnimation>
                
                <AnimatedSpan client:load className="text-accent">
                  {"> Initializing Modus Zero Core..."}
                </AnimatedSpan>
                
                <AnimatedSpan client:load className="text-blue-500">
                  {"> AI Engine Online: Precision 99.9%"}
                </AnimatedSpan>

                <TypingAnimation client:load delay={1000}>{"$ mod0 analyze --all"}</TypingAnimation>

                <AnimatedSpan client:load className="text-green-500">
                  {"âœ” Workflow optimized. Ready to build."}
                </AnimatedSpan>
              </Terminal>
            </div>

            <div class="absolute inset-0 bg-linear-to-t from-accent/5 via-transparent to-transparent translate-y-full animate-[scan_6s_linear_infinite] pointer-events-none z-20"></div>

            <div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-[120%] h-[120%] bg-accent/15 blur-[100px] rounded-full -z-10 animate-pulse"></div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <Features featuresConfig={MOD0_FULL_CONFIG.features} />
  <HowItWorks howItWorksConfig={MOD0_FULL_CONFIG.howItWorks} />
  <FAQ faqConfig={MOD0_FULL_CONFIG.faq} />
  <FutureNews futureNewsConfig={MOD0_FULL_CONFIG.news} />
</div>

<style>
  .hero-title {
    color: var(--text-main);
    text-shadow: 0 4px 24px rgba(255, 255, 255, 0.4);
  }

  :global(.dark) .hero-title {
    text-shadow: 0 4px 32px rgba(0, 0, 0, 0.8);
  }

  .terminal-wrapper {
    box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.15);
  }
  
  :global(.dark) .terminal-wrapper {
    box-shadow: 0 40px 80px -15px rgba(0, 0, 0, 0.6);
  }

  @keyframes scan {
    0% { transform: translateY(100%); }
    100% { transform: translateY(-100%); }
  }
</style>